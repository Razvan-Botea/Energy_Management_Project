{"ast":null,"code":"const API_URL = 'http://localhost:8000/api';\n\n// Helper function to handle fetch responses\nconst handleResponse = async response => {\n  // Get the response as text first\n  const text = await response.text();\n  if (!response.ok) {\n    // If it's an error, try to parse the text as a JSON error message\n    let errorData = {\n      message: `Error: ${response.status}`\n    };\n    try {\n      if (text) {\n        errorData = JSON.parse(text);\n      }\n    } catch (e) {\n      // Ignore if error response wasn't JSON\n    }\n    throw new Error(errorData.message || `Error: ${response.status}`);\n  }\n\n  // If the response is OK but the text is empty (like on create or delete),\n  // just return successfully without parsing.\n  if (text.length === 0) {\n    return;\n  }\n\n  // If we're here, the response is OK and has text, so parse it.\n  return JSON.parse(text);\n};\n\n// Creates the auth header\nconst getAuthHeaders = token => {\n  return {\n    'Content-Type': 'application/json',\n    'Authorization': `Bearer ${token}`\n  };\n};\n\n// --- Auth Service ---\nexport const login = (username, password) => {\n  return fetch(`${API_URL}/auth/login`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  }).then(handleResponse);\n};\n\n// --- User Service ---\nexport const getUsers = token => {\n  return fetch(`${API_URL}/users`, {\n    headers: getAuthHeaders(token)\n  }).then(handleResponse);\n};\nexport const createUser = (token, user) => {\n  return fetch(`${API_URL}/users`, {\n    method: 'POST',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(user)\n  }).then(handleResponse);\n};\nexport const updateUser = (token, id, user) => {\n  return fetch(`${API_URL}/users/${id}`, {\n    method: 'PUT',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(user)\n  }); // PUT might not return content\n};\nexport const deleteUser = (token, id) => {\n  return fetch(`${API_URL}/users/${id}`, {\n    method: 'DELETE',\n    headers: getAuthHeaders(token)\n  }).then(handleResponse);\n};\n\n// --- Device Service ---\nexport const getDevices = token => {\n  return fetch(`${API_URL}/devices`, {\n    headers: getAuthHeaders(token)\n  }).then(handleResponse);\n};\nexport const getDevicesForUser = (token, userId) => {\n  return fetch(`${API_URL}/devices/user/${userId}`, {\n    headers: getAuthHeaders(token)\n  }).then(handleResponse);\n};\nexport const createDevice = (token, device) => {\n  return fetch(`${API_URL}/devices`, {\n    method: 'POST',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(device)\n  });\n};\nexport const updateDevice = (token, id, device) => {\n  return fetch(`${API_URL}/devices/${id}`, {\n    method: 'PUT',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(device)\n  });\n};\nexport const deleteDevice = (token, id) => {\n  return fetch(`${API_URL}/devices/${id}`, {\n    method: 'DELETE',\n    headers: getAuthHeaders(token)\n  }).then(handleResponse);\n};\nexport const getEnergyConsumption = (token, deviceId, dateTimestamp) => {\n  return fetch(`${API_URL}/monitoring/${deviceId}/${dateTimestamp}`, {\n    headers: getAuthHeaders(token)\n  }).then(handleResponse);\n};","map":{"version":3,"names":["API_URL","handleResponse","response","text","ok","errorData","message","status","JSON","parse","e","Error","length","getAuthHeaders","token","login","username","password","fetch","method","headers","body","stringify","then","getUsers","createUser","user","updateUser","id","deleteUser","getDevices","getDevicesForUser","userId","createDevice","device","updateDevice","deleteDevice","getEnergyConsumption","deviceId","dateTimestamp"],"sources":["/home/razvan/LabSD/frontend/src/services/api.js"],"sourcesContent":["const API_URL = 'http://localhost:8000/api';\n\n// Helper function to handle fetch responses\nconst handleResponse = async (response) => {\n  // Get the response as text first\n  const text = await response.text();\n\n  if (!response.ok) {\n    // If it's an error, try to parse the text as a JSON error message\n    let errorData = { message: `Error: ${response.status}` };\n    try {\n      if (text) {\n        errorData = JSON.parse(text);\n      }\n    } catch (e) {\n      // Ignore if error response wasn't JSON\n    }\n    throw new Error(errorData.message || `Error: ${response.status}`);\n  }\n\n  // If the response is OK but the text is empty (like on create or delete),\n  // just return successfully without parsing.\n  if (text.length === 0) {\n    return;\n  }\n\n  // If we're here, the response is OK and has text, so parse it.\n  return JSON.parse(text);\n};\n\n// Creates the auth header\nconst getAuthHeaders = (token) => {\n  return {\n    'Content-Type': 'application/json',\n    'Authorization': `Bearer ${token}`,\n  };\n};\n\n// --- Auth Service ---\nexport const login = (username, password) => {\n  return fetch(`${API_URL}/auth/login`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({ username, password }),\n  }).then(handleResponse);\n};\n\n// --- User Service ---\nexport const getUsers = (token) => {\n  return fetch(`${API_URL}/users`, {\n    headers: getAuthHeaders(token),\n  }).then(handleResponse);\n};\n\nexport const createUser = (token, user) => {\n  return fetch(`${API_URL}/users`, {\n    method: 'POST',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(user),\n  }).then(handleResponse);\n};\n\nexport const updateUser = (token, id, user) => {\n  return fetch(`${API_URL}/users/${id}`, {\n    method: 'PUT',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(user),\n  }); // PUT might not return content\n};\n\nexport const deleteUser = (token, id) => {\n  return fetch(`${API_URL}/users/${id}`, {\n    method: 'DELETE',\n    headers: getAuthHeaders(token),\n  }).then(handleResponse);\n};\n\n// --- Device Service ---\nexport const getDevices = (token) => {\n  return fetch(`${API_URL}/devices`, {\n    headers: getAuthHeaders(token),\n  }).then(handleResponse);\n};\n\nexport const getDevicesForUser = (token, userId) => {\n  return fetch(`${API_URL}/devices/user/${userId}`, {\n    headers: getAuthHeaders(token),\n  }).then(handleResponse);\n};\n\nexport const createDevice = (token, device) => {\n  return fetch(`${API_URL}/devices`, {\n    method: 'POST',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(device),\n  });\n};\n\nexport const updateDevice = (token, id, device) => {\n  return fetch(`${API_URL}/devices/${id}`, {\n    method: 'PUT',\n    headers: getAuthHeaders(token),\n    body: JSON.stringify(device),\n  });\n};\n\nexport const deleteDevice = (token, id) => {\n  return fetch(`${API_URL}/devices/${id}`, {\n    method: 'DELETE',\n    headers: getAuthHeaders(token),\n  }).then(handleResponse);\n};\n\nexport const getEnergyConsumption = (token, deviceId, dateTimestamp) => {\n  return fetch(`${API_URL}/monitoring/${deviceId}/${dateTimestamp}`, {\n    headers: getAuthHeaders(token),\n  }).then(handleResponse);\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}